2024-10-18 16:44:02,842 [trainer.py] => config: ./exps/ease_ina_in21k.json
2024-10-18 16:44:02,842 [trainer.py] => prefix:  
2024-10-18 16:44:02,843 [trainer.py] => dataset: imageneta
2024-10-18 16:44:02,843 [trainer.py] => memory_size: 0
2024-10-18 16:44:02,843 [trainer.py] => memory_per_class: 0
2024-10-18 16:44:02,843 [trainer.py] => fixed_memory: False
2024-10-18 16:44:02,844 [trainer.py] => shuffle: True
2024-10-18 16:44:02,844 [trainer.py] => init_cls: 20
2024-10-18 16:44:02,844 [trainer.py] => increment: 20
2024-10-18 16:44:02,844 [trainer.py] => model_name: ease
2024-10-18 16:44:02,844 [trainer.py] => backbone_type: vit_base_patch16_224_in21k_ease
2024-10-18 16:44:02,844 [trainer.py] => device: [device(type='cpu')]
2024-10-18 16:44:02,844 [trainer.py] => seed: 1993
2024-10-18 16:44:02,845 [trainer.py] => init_epochs: 20
2024-10-18 16:44:02,845 [trainer.py] => init_lr: 0.05
2024-10-18 16:44:02,845 [trainer.py] => later_epochs: 20
2024-10-18 16:44:02,845 [trainer.py] => later_lr: 0.05
2024-10-18 16:44:02,845 [trainer.py] => batch_size: 32
2024-10-18 16:44:02,845 [trainer.py] => weight_decay: 0.005
2024-10-18 16:44:02,845 [trainer.py] => min_lr: 0
2024-10-18 16:44:02,845 [trainer.py] => optimizer: sgd
2024-10-18 16:44:02,845 [trainer.py] => scheduler: cosine
2024-10-18 16:44:02,846 [trainer.py] => pretrained: True
2024-10-18 16:44:02,846 [trainer.py] => vpt_type: Deep
2024-10-18 16:44:02,846 [trainer.py] => prompt_token_num: 5
2024-10-18 16:44:02,846 [trainer.py] => ffn_num: 64
2024-10-18 16:44:02,846 [trainer.py] => use_diagonal: False
2024-10-18 16:44:02,846 [trainer.py] => recalc_sim: True
2024-10-18 16:44:02,846 [trainer.py] => alpha: 0.1
2024-10-18 16:44:02,846 [trainer.py] => use_init_ptm: False
2024-10-18 16:44:02,847 [trainer.py] => beta: 0
2024-10-18 16:44:02,847 [trainer.py] => use_old_data: False
2024-10-18 16:44:02,847 [trainer.py] => use_reweight: True
2024-10-18 16:44:02,847 [trainer.py] => moni_adam: False
2024-10-18 16:44:02,847 [trainer.py] => adapter_num: -1
2024-10-18 16:44:03,076 [data_manage.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-10-18 16:44:05,893 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg_in21k)
2024-10-18 16:47:39,402 [_hub.py] => [timm/vit_base_patch16_224.augreg_in21k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2024-10-18 16:47:39,771 [trainer.py] => All params: 86988288
2024-10-18 16:47:39,772 [trainer.py] => Trainable params: 1189632
2024-10-18 16:47:39,773 [ease.py] => Learning on 0-20
2024-10-18 18:38:04,424 [ease.py] => Task 0, Epoch 20/20 => Loss 0.507, Train_accy 88.23
2024-10-18 18:41:58,121 [ease.py] => Task correct: 100.0
2024-10-18 18:41:58,121 [ease.py] => Task acc: 82.85714285714286
2024-10-18 18:41:58,231 [trainer.py] => No NME accuracy.
2024-10-18 18:41:58,232 [trainer.py] => CNN: {'total': 82.86, '00-19': 82.86, 'old': nan, 'new': 82.86}
2024-10-18 18:41:58,233 [trainer.py] => CNN top1 curve: [82.86]
2024-10-18 18:41:58,233 [trainer.py] => CNN top5 curve: [97.71]

2024-10-18 18:41:58,234 [trainer.py] => Average Accuracy (CNN): 82.86 

2024-10-18 18:41:58,235 [trainer.py] => All params: 87019010
2024-10-18 18:41:58,236 [trainer.py] => Trainable params: 1189632
2024-10-18 18:41:58,242 [ease.py] => Learning on 20-40
2024-10-18 20:30:41,059 [ease.py] => Task 1, Epoch 20/20 => Loss 0.507, Train_accy 88.51
2024-10-18 20:39:21,126 [ease.py] => Task correct: 88.88888888888889
2024-10-18 20:39:21,127 [ease.py] => Task acc: 83.61111111111111
2024-10-18 20:39:21,166 [trainer.py] => No NME accuracy.
2024-10-18 20:39:21,166 [trainer.py] => CNN: {'total': 77.22, '00-19': 75.43, '20-39': 78.92, 'old': 75.43, 'new': 78.92}
2024-10-18 20:39:21,167 [trainer.py] => CNN top1 curve: [82.86, 77.22]
2024-10-18 20:39:21,167 [trainer.py] => CNN top5 curve: [97.71, 95.0]

2024-10-18 20:39:21,167 [trainer.py] => Average Accuracy (CNN): 80.03999999999999 

2024-10-18 20:39:21,168 [trainer.py] => All params: 87065090
2024-10-18 20:39:21,169 [trainer.py] => Trainable params: 1189632
2024-10-18 20:39:21,172 [ease.py] => Learning on 40-60
2024-10-18 21:55:01,987 [ease.py] => Task 2, Epoch 20/20 => Loss 0.478, Train_accy 92.37
2024-10-18 22:08:03,268 [ease.py] => Task correct: 81.30252100840336
2024-10-18 22:08:03,269 [ease.py] => Task acc: 83.40336134453781
2024-10-18 22:08:03,313 [trainer.py] => No NME accuracy.
2024-10-18 22:08:03,313 [trainer.py] => CNN: {'total': 71.43, '00-19': 71.43, '20-39': 71.89, '40-59': 70.69, 'old': 71.67, 'new': 70.69}
2024-10-18 22:08:03,314 [trainer.py] => CNN top1 curve: [82.86, 77.22, 71.43]
2024-10-18 22:08:03,314 [trainer.py] => CNN top5 curve: [97.71, 95.0, 92.02]

2024-10-18 22:08:03,314 [trainer.py] => Average Accuracy (CNN): 77.17 

2024-10-18 22:08:03,315 [trainer.py] => All params: 87141890
2024-10-18 22:08:03,316 [trainer.py] => Trainable params: 1189632
2024-10-18 22:08:03,320 [ease.py] => Learning on 60-80
2024-10-19 00:14:06,081 [ease.py] => Task 3, Epoch 20/20 => Loss 0.444, Train_accy 88.78
2024-10-19 00:41:47,295 [ease.py] => Task correct: 75.93123209169055
2024-10-19 00:41:47,296 [ease.py] => Task acc: 84.9570200573066
2024-10-19 00:41:47,370 [trainer.py] => No NME accuracy.
2024-10-19 00:41:47,372 [trainer.py] => CNN: {'total': 69.34, '00-19': 64.57, '20-39': 65.95, '40-59': 64.66, '60-79': 78.38, 'old': 65.13, 'new': 78.38}
2024-10-19 00:41:47,372 [trainer.py] => CNN top1 curve: [82.86, 77.22, 71.43, 69.34]
2024-10-19 00:41:47,373 [trainer.py] => CNN top5 curve: [97.71, 95.0, 92.02, 90.54]

2024-10-19 00:41:47,373 [trainer.py] => Average Accuracy (CNN): 75.2125 

2024-10-19 00:41:47,375 [trainer.py] => All params: 87249410
2024-10-19 00:41:47,376 [trainer.py] => Trainable params: 1189632
2024-10-19 00:41:47,382 [ease.py] => Learning on 80-100
2024-10-19 02:07:06,625 [ease.py] => Task 4, Epoch 20/20 => Loss 0.390, Train_accy 94.66
2024-10-19 02:35:13,795 [ease.py] => Task correct: 71.3436385255648
2024-10-19 02:35:13,810 [ease.py] => Task acc: 84.42330558858502
2024-10-19 02:35:13,889 [trainer.py] => No NME accuracy.
2024-10-19 02:35:13,889 [trainer.py] => CNN: {'total': 66.11, '00-19': 58.86, '20-39': 62.7, '40-59': 62.07, '60-79': 75.23, '80-99': 68.53, 'old': 65.62, 'new': 68.53}
2024-10-19 02:35:13,889 [trainer.py] => CNN top1 curve: [82.86, 77.22, 71.43, 69.34, 66.11]
2024-10-19 02:35:13,889 [trainer.py] => CNN top5 curve: [97.71, 95.0, 92.02, 90.54, 87.87]

2024-10-19 02:35:13,896 [trainer.py] => Average Accuracy (CNN): 73.39200000000001 
